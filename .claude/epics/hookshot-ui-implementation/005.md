---
name: Request List & Filtering
status: open
created: 2026-01-30T08:03:38Z
updated: 2026-01-30T08:03:38Z
github: [To be updated during sync]
depends_on: [002, 003]
parallel: true
conflicts_with: [004]
---

# Task: Request List & Filtering

## Description

Implement the request list with virtual scrolling, filtering by HTTP method, and search functionality. This is the core viewing area where developers see incoming webhook requests in real-time.

**Scope:**
- Request list with virtual scrolling (@tanstack/react-virtual)
- Request items with method badges, timestamps, paths
- Filter dropdown for HTTP methods (GET, POST, PUT, DELETE, ALL)
- Search input for headers and body (debounced 300ms)
- Empty state for no requests
- Loading state during fetch

## Acceptance Criteria

- [ ] Request list displays all requests for selected endpoint
- [ ] Requests sorted by timestamp (newest first)
- [ ] Virtual scrolling handles 1000+ requests at 60fps
- [ ] Method filter works (can select multiple methods)
- [ ] Search filters requests by headers or body content
- [ ] Search is debounced to 300ms
- [ ] Filter + search work together (AND logic)
- [ ] "Clear filters" button resets all filters
- [ ] Empty state shows when no requests match filters
- [ ] Timestamps update every 60 seconds ("2m ago" â†’ "3m ago")
- [ ] Clicking request opens detail panel

## Technical Details

### Components to Create

1. **RequestList** (`components/request/RequestList.tsx`)
   ```typescript
   export function RequestList() {
     const { requests, loading } = useRequests(selectedEndpointId);
     const [filters, setFilters] = useState({ methods: [], search: '' });

     const filtered = useMemo(() => {
       return requests.filter(req => {
         if (filters.methods.length && !filters.methods.includes(req.method)) {
           return false;
         }
         if (filters.search) {
           const search = filters.search.toLowerCase();
           const inHeaders = JSON.stringify(req.headers).toLowerCase().includes(search);
           const inBody = req.body?.toLowerCase().includes(search);
           return inHeaders || inBody;
         }
         return true;
       });
     }, [requests, filters]);

     return (
       <div className="flex flex-col h-full">
         <div className="flex-none p-4 border-b border-border">
           <RequestFilters filters={filters} onChange={setFilters} />
           <RequestSearch value={filters.search} onChange={s => setFilters(f => ({ ...f, search: s }))} />
         </div>
         <div className="flex-1 overflow-auto">
           {loading ? <LoadingSpinner /> : <VirtualRequestList requests={filtered} />}
         </div>
       </div>
     );
   }
   ```

2. **VirtualRequestList** (`components/request/VirtualRequestList.tsx`)
   ```typescript
   import { useVirtualizer } from '@tanstack/react-virtual';

   export function VirtualRequestList({ requests }: { requests: Request[] }) {
     const parentRef = useRef<HTMLDivElement>(null);

     const virtualizer = useVirtualizer({
       count: requests.length,
       getScrollElement: () => parentRef.current,
       estimateSize: () => 72, // Estimated height of each request item
       overscan: 5,
     });

     if (requests.length === 0) {
       return <EmptyState message="No requests captured yet" />;
     }

     return (
       <div ref={parentRef} className="h-full overflow-auto">
         <div
           style={{
             height: `${virtualizer.getTotalSize()}px`,
             width: '100%',
             position: 'relative',
           }}
         >
           {virtualizer.getVirtualItems().map((virtualRow) => (
             <div
               key={virtualRow.index}
               style={{
                 position: 'absolute',
                 top: 0,
                 left: 0,
                 width: '100%',
                 height: `${virtualRow.size}px`,
                 transform: `translateY(${virtualRow.start}px)`,
               }}
             >
               <RequestItem request={requests[virtualRow.index]} />
             </div>
           ))}
         </div>
       </div>
     );
   }
   ```

3. **RequestItem** (`components/request/RequestItem.tsx`)
   ```typescript
   export function RequestItem({ request }: { request: Request }) {
     const [selected, setSelected] = useState(false);

     return (
       <div
         onClick={() => setSelected(true)}
         className="px-4 py-3 border-b border-border hover:bg-surface cursor-pointer"
       >
         <div className="flex items-center gap-3">
           <RequestBadge method={request.method} />
           <div className="flex-1 min-w-0">
             <p className="text-sm text-text-primary truncate">{request.path}</p>
             <p className="text-xs text-text-secondary">
               <RelativeTimestamp date={request.received_at} />
             </p>
           </div>
           <p className="text-xs text-text-tertiary">{request.ip_address}</p>
         </div>
       </div>
     );
   }
   ```

4. **RequestBadge** (`components/request/RequestBadge.tsx`)
   ```typescript
   const METHOD_COLORS = {
     GET: 'bg-accent-purple text-white',
     POST: 'bg-accent-green text-white',
     PUT: 'bg-accent-yellow text-white',
     DELETE: 'bg-accent-red text-white',
     PATCH: 'bg-accent-blue text-white',
   };

   export function RequestBadge({ method }: { method: string }) {
     const color = METHOD_COLORS[method] || 'bg-gray-500 text-white';

     return (
       <span className={`px-2 py-1 text-xs font-semibold rounded ${color}`}>
         {method}
       </span>
     );
   }
   ```

5. **RequestFilters** (`components/request/RequestFilters.tsx`)
   ```typescript
   const METHODS = ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'];

   export function RequestFilters({ filters, onChange }) {
     function toggleMethod(method: string) {
       const methods = filters.methods.includes(method)
         ? filters.methods.filter(m => m !== method)
         : [...filters.methods, method];
       onChange({ ...filters, methods });
     }

     return (
       <div className="flex items-center gap-2 mb-3">
         <span className="text-sm text-text-secondary">Filter:</span>
         {METHODS.map(method => (
           <button
             key={method}
             onClick={() => toggleMethod(method)}
             className={`px-3 py-1 text-xs rounded ${
               filters.methods.includes(method)
                 ? 'bg-accent-blue text-white'
                 : 'bg-surface text-text-secondary hover:bg-surface-hover'
             }`}
           >
             {method}
           </button>
         ))}
         {filters.methods.length > 0 && (
           <button
             onClick={() => onChange({ ...filters, methods: [] })}
             className="text-xs text-accent-red hover:underline"
           >
             Clear
           </button>
         )}
       </div>
     );
   }
   ```

6. **RequestSearch** (`components/request/RequestSearch.tsx`)
   ```typescript
   export function RequestSearch({ value, onChange }) {
     const [input, setInput] = useState(value);

     // Debounce search input
     useEffect(() => {
       const timeout = setTimeout(() => {
         onChange(input);
       }, 300);
       return () => clearTimeout(timeout);
     }, [input, onChange]);

     return (
       <div className="relative">
         <SearchIcon className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-tertiary" />
         <input
           type="text"
           value={input}
           onChange={(e) => setInput(e.target.value)}
           placeholder="Search headers or body..."
           className="w-full pl-10 pr-4 py-2 bg-surface border border-border rounded-lg text-sm text-text-primary placeholder:text-text-tertiary focus:outline-none focus:ring-2 focus:ring-accent-blue"
         />
       </div>
     );
   }
   ```

7. **RelativeTimestamp** (`components/ui/RelativeTimestamp.tsx`)
   ```typescript
   export function RelativeTimestamp({ date }: { date: string }) {
     const [relative, setRelative] = useState('');

     useEffect(() => {
       function updateTime() {
         const now = new Date();
         const then = new Date(date);
         const diff = Math.floor((now.getTime() - then.getTime()) / 1000);

         if (diff < 60) setRelative(`${diff}s ago`);
         else if (diff < 3600) setRelative(`${Math.floor(diff / 60)}m ago`);
         else if (diff < 86400) setRelative(`${Math.floor(diff / 3600)}h ago`);
         else setRelative(`${Math.floor(diff / 86400)}d ago`);
       }

       updateTime();
       const interval = setInterval(updateTime, 60000); // Update every minute
       return () => clearInterval(interval);
     }, [date]);

     return <span title={date}>{relative}</span>;
   }
   ```

### Performance Considerations

- **Virtual Scrolling**: Only renders ~20 visible items + 5 overscan
- **Debounced Search**: Prevents excessive re-renders during typing
- **Memoized Filtering**: Uses React.useMemo to cache filtered results
- **Request Limit**: Backend should limit to 100-1000 requests per endpoint

## Dependencies

### Blocking Dependencies
- [ ] Task 002: Core Layout (RequestList panel)
- [ ] Task 003: API Client (useRequests hook)

### External Dependencies
- [ ] Install @tanstack/react-virtual
  ```bash
  npm install @tanstack/react-virtual
  ```

## Effort Estimate

- **Size:** Medium (M)
- **Hours:** 8-10 hours
- **Parallel:** true (can work alongside Task 004, 006)

**Breakdown:**
- RequestList component: 1.5 hours
- VirtualRequestList with @tanstack/react-virtual: 2 hours
- RequestItem component: 1 hour
- RequestBadge component: 0.5 hours
- RequestFilters component: 1.5 hours
- RequestSearch with debouncing: 1.5 hours
- RelativeTimestamp component: 1 hour
- Testing with 1000+ requests: 1.5 hours

## Definition of Done

- [ ] Virtual scrolling performs at 60fps with 1000+ requests
- [ ] Filtering by method works correctly
- [ ] Search filters headers and body
- [ ] Debouncing prevents lag while typing
- [ ] Combined filters work (method + search)
- [ ] Clear filters button resets state
- [ ] Empty state shows when no results
- [ ] Timestamps update every minute
- [ ] Clicking request opens detail panel (next task)
- [ ] No memory leaks during long sessions

## Notes

- Consider adding request count indicator: "Showing 45 of 120 requests"
- Add "Auto-scroll" toggle to follow new requests
- Consider infinite scroll instead of loading all upfront
- Add export filtered results button (future)
- Keyboard navigation: Arrow keys to navigate, Enter to select

## References

- @tanstack/react-virtual: https://tanstack.com/virtual/latest
- Debouncing in React: https://www.developerway.com/posts/debouncing-in-react
